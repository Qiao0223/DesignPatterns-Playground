# 原型模式

原型模式（Prototype Pattern）是一种创建型设计模式，它通过复制一个已有的实例来创建新的对象，而不是通过 new 关键字来直接构建对象。原型模式允许你克隆（复制）一个对象，而不需要了解该对象的具体类，从而降低了创建对象时的复杂性和耦合度。

##  **适用场景**

原型模式适用于以下情况：

1. **对象创建过程较为复杂**：当对象的创建过程涉及到较复杂的操作，或者某些对象的创建是资源消耗较大的时候，使用原型模式可以通过复制现有对象来快速创建新的对象，避免重复创建。
2. **需要避免多次初始化相同的对象**：在某些情况下，相同的对象可能需要多次创建，且这些对象的属性比较复杂，使用原型模式可以通过克隆已有的实例来避免多次初始化。
3. **对象状态可以被复制**：当对象的状态是可复制的，并且不依赖于对象创建时的上下文时，原型模式尤为适用。

## **结构**

原型模式的结构通常包含以下几个组成部分：

- **Prototype（原型）**：声明一个克隆自身的 `clone()` 方法。通常这是一个接口或抽象类，定义了所有具体原型类需要实现的克隆方法。
- **ConcretePrototype（具体原型类）**：实现了 `clone()` 方法，具体负责复制对象。

## **优缺点**

### 优点：

1. **性能优化**：创建新对象时，通过克隆现有对象来避免昂贵的对象创建操作，尤其是在对象构造复杂、资源消耗大的场景下，原型模式能够显著提高性能。
2. **避免重复初始化**：避免了重复初始化对象的复杂过程，尤其是在多次创建相似对象时（例如配置对象、资源池等场景）。
3. **灵活性和扩展性**：通过克隆对象，可以灵活地改变或扩展对象的状态。

### 缺点：

4. **深拷贝 vs 浅拷贝**：克隆对象时需要小心是使用深拷贝还是浅拷贝。浅拷贝会共享对象的引用，可能导致数据不一致的问题；而深拷贝则会复制对象的所有层次，导致实现复杂度增加。
5. **复杂性**：如果对象结构复杂，或者对象中包含复杂的引用类型，克隆操作可能会变得复杂，且需要处理复杂的状态管理。

##  **深拷贝和浅拷贝**

- **浅拷贝（Shallow Copy）**：仅复制对象的基础类型字段，对于引用类型的字段，浅拷贝只复制引用地址，而不会复制实际引用的对象。换句话说，浅拷贝后的对象和原对象共享引用类型字段的内容。
- **深拷贝（Deep Copy）**：复制对象及其所有引用对象，创建新的对象并复制原对象的所有属性和引用的对象。深拷贝保证新对象和原对象完全独立。